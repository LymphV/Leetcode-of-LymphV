#if defined(LocalLymphV)
#include "../../leetcode.h"
#include <LymphV>
#else
#define print(...) 0
#endif

#if !defined(LocalLymphV) || !defined(DebugLymphV)
#define debug(x) 0
#endif
/**
假设有打乱顺序的一群人站成一个队列。 每个人由一个整数对(h, k)表示，其中h是这个人的身高，k是排在这个人前面且身高大于或等于h的人数。 编写一个算法来重建这个队列。

注意：
总人数少于1100人。

示例

输入:
[[7,0], [4,4], [7,1], [5,0], [6,1], [5,2]]

输出:
[[5,0], [7,0], [5,2], [6,1], [4,4], [7,1]]

来源：力扣（LeetCode）
链接：https://leetcode-cn.com/problems/queue-reconstruction-by-height
著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。
*/


#define FOR(x,y) for (int x = 0; x < y; ++x)
#define ffor(x,y,z) for (int x = y; x < z; ++x)

class Solution {///328ms 49.29% 11.7M 53.65%
    using vi = vector<int>;
public:
    vector<vector<int>> reconstructQueue(vector<vector<int>>& people) {
        sort(begin(people), end(people), [](vi & x, vi & y)
        {
            return x[0] > y[0] || x[0] == y[0] && x[1] < y[1];
        });

        vector<vi> rst;
        for (vi & v : people) rst.insert(begin(rst) + v[1], v);
        return rst;
    }
};

///map优化
class SolutionV3 {///TLE
    using vi = vector<int>;
    using piq = pair<int,queue<int>>;

    auto getMin (map<int, piq> & mp)
    {
        for (auto i = mp.begin(); i != mp.end(); ++i)
        {
            auto [x, y] = i->second;
            if (y.front() - x == 0) return i;
        }
        return mp.end();
    }
public:
    vector<vector<int>> reconstructQueue(vector<vector<int>>& people) {
        int n = people.size(), N = 2000;
        if (!n) return {};
        sort(begin(people), end(people));

        map<int, piq> mp;
        for (auto & v : people) mp[v[0]].second.push(v[1]);

        vector<vi> rst;
        FOR(i,n)
        {
            auto minE = getMin(mp);
            int h = minE->first, f = minE->second.second.front();
            rst.emplace_back(vi{h, f});
            minE->second.second.pop();
            if (minE->second.second.empty()) mp.erase(minE);

            for (auto & [x, y] : mp)
            {
                if (x <= h) ++y.first;
                else break;
            }
        }
        return rst;
    }
};

///排序暴力
class SolutionV2 {///224ms 58.97% 12.7M 22.17%
    using vi = vector<int>;

    vi & getMin (vector<vi> & ps)
    {
        for (vi & v : ps) if (!v[0]) return v;
        return ps[0];
    }
public:
    vector<vector<int>> reconstructQueue(vector<vector<int>>& people) {
        int n = people.size(), N = 2000;
        if (!n) return {};
        sort(begin(people), end(people));
        vector<vi> ps, rst;
        for (auto & v : people) ps.emplace_back(vi{v[1], v[0], v[1]});
        FOR(i,n)
        {
            auto & minE = getMin(ps);
            rst.emplace_back(vi{minE[1], minE[2]});
            minE[0] = N;
            for (auto & v: ps)
            {
                if (v[1] <= minE[1])
                {
                    if (v[0] != N) --v[0];
                }
                else break;
            }
        }
        return rst;
    }
};

///暴力
class SolutionV1 {///1360ms 5.16% 12.4M 25.07%
    using vi = vector<int>;
public:
    vector<vector<int>> reconstructQueue(vector<vector<int>>& people) {
        int n = people.size(), N = 2000;
        if (!n) return {};
        vector<vi> ps, rst;
        for (auto & v : people) ps.emplace_back(vi{v[1], v[0], v[1]});
        FOR(i,n)
        {
            auto & minE = *min_element(begin(ps), end(ps));
            rst.emplace_back(vi{minE[1], minE[2]});
            minE[0] = N;
            for (auto & v: ps) if (v[1] <= minE[1] && v[0] != N) --v[0];
        }
        return rst;
    }
};


#if defined(LocalLymphV)
int main()
{
    vector<vector<vi>> xs{
        {{866898,84},{238709,658},{870873,8},{259954,220},{159247,113},{46235,951},{507398,252},{697478,268},{781428,75},{381703,601},{688044,283},{654103,310},{30407,307},{30655,939},{26334,868},{754256,160},{711522,279},{394535,196},{206421,442},{441554,374},{999330,1},{39530,484},{643578,305},{189547,690},{699559,211},{392626,241},{731504,103},{534295,39},{429748,450},{91455,102},{736019,181},{147343,203},{971385,23},{484956,411},{931666,69},{425720,537},{334005,493},{830851,114},{191652,499},{372127,17},{981617,0},{297512,665},{433194,521},{223176,620},{504679,453},{725150,266},{323077,179},{690562,140},{69113,341},{810840,37},{177537,78},{619885,270},{149500,279},{311435,405},{511569,23},{71294,661},{96549,485},{541607,33},{433906,13},{374168,15},{937684,20},{152058,466},{116309,430},{333957,342},{194364,383},{559498,385},{337904,530},{230326,244},{396217,425},{162097,676},{258995,181},{935603,40},{272431,338},{684928,127},{790764,131},{933253,75},{384599,509},{389878,569},{302177,87},{258677,167},{276222,126},{144770,327},{291039,183},{603038,134},{801286,51},{402116,157},{639052,193},{38994,66},{286233,611},{266817,301},{948287,30},{952119,6},{645441,272},{134936,518},{636554,14},{232989,762},{366041,262},{824147,37},{75465,171},{253675,245},{998522,2},{969503,17},{763851,196},{872865,80},{425629,404},{864006,9},{328713,630},{303706,153},{813246,195},{350894,98},{968030,22},{467943,515},{414105,138},{146984,849},{980077,0},{820660,3},{918331,12},{977748,27},{684357,309},{959887,8},{516434,135},{877948,74},{770742,46},{516840,242},{543,643},{963204,22},{539259,403},{718335,209},{448898,160},{678017,217},{841266,23},{272773,514},{142971,171},{309484,417},{810865,115},{317260,344},{85693,321},{68506,292},{111781,679},{728687,189},{312160,3},{23229,797},{789208,144},{824539,28},{483791,129},{752189,10},{373783,381},{881557,111},{981146,10},{987428,8},{635592,140},{419588,239},{362763,505},{653128,23},{52337,682},{871128,139},{648145,75},{466016,108},{937578,37},{935004,21},{686300,206},{492838,470},{711700,34},{577577,397},{327147,592},{438765,151},{706317,23},{283507,264},{952622,3},{519490,445},{440581,167},{127614,741},{833662,18},{956681,40},{938305,54},{591670,8},{853067,91},{726801,103},{542078,144},{910167,84},{738427,266},{106823,196},{163585,285},{315814,1},{889310,16},{696028,182},{975546,9},{459647,508},{679694,19},{320887,322},{172501,334},{926710,75},{356999,328},{711825,113},{982516,10},{621133,260},{974431,25},{637476,15},{883852,46},{136643,147},{845772,68},{436753,331},{999497,0},{269613,465},{297816,407},{468214,145},{898478,96},{735602,94},{227682,143},{923369,40},{259333,555},{839987,166},{226716,498},{363106,276},{729436,14},{522558,105},{672309,209},{31894,217},{195084,197},{864860,84},{171391,813},{553034,27},{490457,296},{181154,109},{10050,644},{365996,474},{928360,71},{250699,206},{863232,148},{179089,657},{638286,216},{307814,598},{778394,174},{745971,207},{692924,222},{913196,3},{843637,38},{265225,75},{887890,52},{219562,592},{976444,11},{272931,596},{771728,97},{593128,202},{47741,199},{212063,439},{882959,115},{645686,178},{8296,974},{986997,6},{383071,248},{401358,102},{546556,272},{923395,41},{312847,266},{701609,136},{700550,60},{575670,258},{550385,432},{42973,517},{658872,39},{64282,365},{330149,136},{930651,13},{337757,71},{343189,488},{116909,101},{15814,921},{498991,136},{213455,540},{266589,583},{787969,41},{313450,644},{195800,376},{815150,191},{714038,2},{51959,409},{454875,49},{446172,35},{363460,611},{275767,89},{442422,309},{514358,322},{861096,44},{183640,210},{203999,139},{484119,199},{707079,223},{185703,241},{467191,421},{61430,566},{264926,691},{612631,24},{98905,250},{997717,3},{790478,33},{581175,318},{41080,495},{468301,206},{842954,110},{694232,172},{885135,7},{108527,686},{566992,170},{16623,910},{935469,33},{613210,130},{188622,285},{153709,421},{11370,914},{175375,431},{510923,28},{303286,404},{977108,16},{151842,84},{990804,4},{786704,205},{888036,85},{972580,35},{175827,754},{906787,57},{887313,75},{881611,68},{822020,28},{415393,476},{768651,122},{602870,217},{532221,18},{1816,278},{2037,821},{858184,41},{516349,140},{254477,594},{966812,38},{48155,765},{913287,43},{970592,9},{969397,22},{263347,574},{78961,521},{887546,46},{117713,724},{371412,524},{63429,721},{946036,18},{730250,175},{2037,499},{462977,264},{804238,180},{788742,172},{907046,33},{902208,24},{753834,42},{102362,606},{363867,465},{139773,104},{833541,3},{983259,13},{672986,313},{504275,484},{465907,409},{995195,5},{422299,242},{611680,261},{486616,166},{531372,426},{585327,194},{784685,162},{81244,600},{681063,330},{306400,663},{85256,414},{435242,392},{196074,321},{98339,746},{6198,602},{634356,195},{385135,47},{223198,415},{785674,154},{317405,359},{368497,285},{240339,447},{74473,317},{223409,594},{943619,58},{176757,505},{551903,441},{631424,46},{445012,29},{141671,704},{673151,250},{554898,186},{641113,2},{711167,214},{811259,94},{842941,114},{257385,56},{627149,215},{642337,366},{61222,392},{64566,717},{109077,218},{549760,277},{117930,188},{995322,5},{271702,157},{759223,90},{364036,618},{718418,216},{580294,366},{725652,44},{367149,331},{306175,288},{860725,14},{786587,66},{699331,44},{651648,285},{755650,137},{467830,188},{154500,430},{514321,453},{676289,191},{51214,532},{991933,2},{19425,769},{115871,674},{64266,653},{320489,517},{839285,46},{48686,519},{876604,57},{633836,13},{674589,219},{454235,371},{536271,127},{715837,211},{39037,900},{711337,4},{208560,94},{979623,7},{199324,192},{477828,185},{461672,165},{315076,506},{59094,788},{862095,37},{265128,246},{987956,10},{340755,503},{224640,133},{749264,176},{542609,96},{232485,690},{950723,24},{478015,257},{386059,491},{891741,13},{747430,154},{879283,125},{176736,322},{338979,420},{156682,680},{883865,90},{619603,42},{265690,271},{456393,509},{626110,317},{555438,201},{411965,449},{52099,8},{436784,181},{744953,17},{954454,4},{211168,686},{886159,45},{246616,285},{132839,699},{778574,78},{173788,433},{585467,294},{405682,155},{506467,188},{939099,30},{637733,372},{606285,409},{749802,133},{11521,536},{135899,326},{324310,498},{846753,156},{275019,700},{252527,400},{816284,109},{988610,11},{699454,190},{727241,265},{343341,269},{602038,148},{432834,401},{763364,5},{974898,15},{298766,617},{551004,70},{842504,162},{181086,289},{761681,172},{175635,551},{810423,94},{990609,8},{732106,117},{184288,788},{218295,243},{454237,318},{929969,77},{587495,216},{399472,117},{775226,91},{840197,121},{700422,256},{957102,33},{370405,549},{391546,400},{542088,343},{751094,246},{322823,326},{761862,243},{976434,23},{504134,66},{103628,843},{331303,87},{970178,29},{736287,241},{450023,151},{368551,262},{284724,258},{485251,471},{514811,229},{307433,441},{296989,489},{3997,608},{739053,3},{333888,379},{837733,104},{261606,170},{70189,167},{285946,550},{455685,278},{307282,141},{814883,3},{396215,244},{542713,238},{78317,396},{385768,356},{779365,14},{313531,45},{385245,278},{715576,144},{477142,113},{635726,118},{449719,30},{653527,150},{414250,177},{25949,836},{829366,49},{652431,83},{617471,321},{260856,505},{905442,77},{219953,765},{920849,67},{289773,566},{961895,17},{523411,230},{935545,12},{338464,611},{842263,103},{551377,316},{493679,330},{604393,123},{939723,24},{997892,0},{73957,680},{336620,425},{284428,53},{526395,276},{11563,13},{994831,8},{837233,88},{198110,563},{549899,148},{167172,631},{532239,36},{681850,287},{449426,468},{98887,112},{884888,82},{557065,374},{381715,419},{401997,433},{69830,691},{178553,405},{277874,380},{619778,61},{994001,9},{616188,123},{706806,189},{311851,187},{895680,99},{188759,119},{955913,45},{618940,206},{151947,358},{415835,317},{438156,29},{669035,15},{605814,117},{76427,849},{747530,217},{378413,274},{957751,13},{431524,150},{516865,90},{288939,323},{411270,144},{232649,487},{525951,356},{416100,502},{965196,31},{83506,192},{675436,177},{256289,219},{734307,214},{607275,307},{756556,178},{951742,57},{143917,643},{344223,118},{999209,2},{248370,721},{640700,303},{421335,181},{426384,518},{890046,1},{174037,403},{354711,453},{159483,56},{414873,68},{678669,255},{37210,504},{235085,404},{401701,341},{476153,367},{326785,377},{544006,220},{263048,389},{460531,61},{614302,367},{38772,435},{376971,560},{753713,23},{735862,206},{921877,64},{272854,533},{653071,58},{980264,4},{150831,662},{753801,66},{56328,146},{285434,712},{14183,461},{692191,316},{887680,42},{980199,3},{672721,328},{606992,136},{210467,34},{458760,154},{127732,237},{459946,101},{198377,433},{470798,187},{734352,87},{667916,14},{675077,240},{727042,96},{429240,141},{343846,353},{291436,501},{623860,291},{639225,361},{375638,99},{835938,23},{318877,66},{988827,6},{38495,784},{906638,56},{129733,788},{122472,780},{324521,252},{349353,318},{581629,156},{199218,560},{177503,650},{730630,66},{207566,76},{124455,191},{579822,337},{745481,48},{231746,179},{136604,712},{95575,260},{841888,2},{963445,17},{571336,32},{638056,43},{713789,128},{909627,84},{775703,15},{676132,74},{376876,44},{416572,501},{424184,507},{721428,105},{922584,19},{228073,652},{571462,401},{351688,556},{437603,506},{665749,31},{990372,8},{820039,152},{874093,1},{94790,506},{887047,91},{630665,102},{349340,628},{266209,548},{710068,92},{500374,72},{960661,42},{892571,63},{400594,393},{79917,259},{192409,138},{473367,157},{762669,227},{50605,810},{103693,785},{642257,293},{225912,477},{233867,404},{116459,650},{326154,105},{477773,320},{910284,43},{912843,5},{623708,354},{907839,73},{858853,39},{888923,28},{709537,281},{906502,101},{488804,46},{493343,364},{782230,102},{630134,287},{233031,490},{28384,423},{840020,136},{240240,533},{191676,317},{401861,100},{296742,225},{641857,155},{256948,83},{877933,114},{774870,116},{323828,52},{379661,313},{704489,214},{170631,230},{745638,146},{59903,359},{237503,265},{126183,860},{731643,237},{770472,3},{16738,595},{636869,179},{400997,379},{541749,335},{339042,375},{337213,475},{279076,349},{198748,472},{719561,204},{949179,54},{552533,437},{461850,225},{876538,80},{154600,374},{806095,50},{913203,41},{10076,272},{290695,699},{88044,225},{554270,172},{98575,471},{25347,488},{605843,378},{4319,583},{541144,182},{512905,377},{728076,183},{739677,257},{766151,193},{636580,46},{485478,156},{77669,211},{225370,214},{145549,505},{381960,248},{97128,93},{144498,598},{367524,249},{942960,32},{799238,203},{624395,83},{619909,29},{4604,959},{870414,134},{874738,108},{176075,427},{738776,167},{46781,268},{266254,24},{857006,146},{291747,183},{884486,58},{558992,15},{268779,445},{61445,649},{770081,218},{68698,495},{406639,470},{275837,535},{459518,483},{104178,540},{907063,27},{539626,431},{852636,132},{285307,55},{685127,234},{622711,173},{175938,556},{737346,231},{105255,0},{257805,21},{372664,348},{554206,77},{129355,516},{374994,457},{376751,70},{150589,322},{606521,403},{92071,736},{621055,52},{539014,445},{720768,197},{159519,338},{184311,72},{705958,15},{84224,251},{12372,422},{872132,92},{263637,380},{46631,637},{108107,200},{852129,106},{51582,126},{286220,630},{407195,373},{763082,8},{790541,84},{989827,4},{906952,43},{679812,286},{565593,396},{830797,173},{199358,114},{437537,393},{178405,495},{714465,42},{202499,379},{187787,366},{648762,146},{635352,351},{830217,174},{160788,477},{443746,89},{835269,3},{3253,920},{943967,11},{827399,8},{716691,144},{987454,16},{908348,3},{653859,16},{125124,165},{319303,338},{17287,554},{624196,268},{168155,437},{403551,280},{270062,505},{828678,170},{571303,342},{569653,420},{882815,71},{709172,89},{571479,309},{110978,483},{229135,624},{76973,702},{895685,1},{689084,277},{522621,132},{114062,873},{636428,49},{538457,352},{551769,389},{354567,549},{131919,625},{658703,177},{806228,27},{618872,150},{301301,240},{823865,159},{878945,129},{497618,332},{305187,233},{701064,279},{584355,20},{45160,846},{353015,365},{69504,5},{219029,276},{828104,172},{338287,303},{861575,77},{649241,173},{21542,591},{788370,34},{885310,0},{342100,444},{507482,100},{376819,506},{426163,374},{290875,185},{403305,539},{853740,20},{59671,194},{869829,18},{249973,723},{797748,8},{763851,149},{573191,275},{359495,596},{40354,348},{197494,167},{915180,70},{922873,53},{478951,306},{530131,204},{355860,252},{199503,504},{898044,19},{85212,511},{927478,14},{29673,399},{645634,248},{856086,81},{754604,64},{807866,202},{242453,228},{954342,1},{778861,188},{266596,701},{177468,675},{336693,43},{133013,390},{781156,193},{98543,287},{719513,43},{246687,635},{267957,97},{818135,166},{860485,10},{653870,273}},
        {{7,0}, {4,4}, {7,1}, {5,0}, {6,1}, {5,2}},
        {}
    };
    for (auto x : xs)
        print(x), print(Solution().reconstructQueue(x)), print("===");
    return 0;
}
#endif
